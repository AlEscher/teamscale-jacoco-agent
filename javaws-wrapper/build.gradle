plugins {
	id 'de.fntsoftware.gradle.markdown-to-pdf' version '1.0.1'
}

apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'com.github.johnrengelman.shadow'

dependencies {
	compile 'org.conqat:org.conqat.lib.commons:0.20160822'
	compile 'org.apache.commons:commons-lang3:3.7'
	compile 'org.apache.commons:commons-exec:1.3'
}

mainClassName = 'eu.cqse.teamscale.jacoco.javaws.Main'

shadowJar {
	baseName = 'teamscale-javaws-wrapper'
	classifier = null
	version = rootProject.appVersion
}

startShadowScripts {
	applicationName = 'javaws'
}

distributions {
	shadow {
		baseName = 'javaws'
		contents {
			from(readmeToPdf) {
				into 'documentation'
			}

			from(project(':eu.cqse.teamscale.jacoco.agent').tasks.shadowJar) {
				rename(/.*/, 'agent.jar')
			}
			from(project(':eu.cqse.teamscale.jacoco.agent').tasks.usageToPdf) {
				rename('USAGE.pdf', 'agent-userguide.pdf')
				into 'documentation'
			}
		}
	}
}